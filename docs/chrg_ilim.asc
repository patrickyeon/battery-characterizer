Version 4
SHEET 1 2260 844
WIRE 720 -1072 688 -1072
WIRE 1728 -1056 1680 -1056
WIRE 1872 -1056 1792 -1056
WIRE 688 -1040 688 -1072
WIRE 1120 -1040 1088 -1040
WIRE 720 -1024 720 -1072
WIRE 720 -1024 704 -1024
WIRE 1120 -1024 1120 -1040
WIRE 704 -1008 704 -1024
WIRE 1088 -1008 1088 -1040
WIRE 528 -992 432 -992
WIRE 672 -992 528 -992
WIRE 816 -976 736 -976
WIRE 672 -960 624 -960
WIRE 432 -944 432 -992
WIRE 432 -944 272 -944
WIRE 272 -928 272 -944
WIRE 704 -928 704 -944
WIRE 1280 -928 1248 -928
WIRE 1248 -896 1248 -928
WIRE 1680 -896 1680 -1056
WIRE 1728 -896 1680 -896
WIRE 1872 -896 1872 -1056
WIRE 1872 -896 1808 -896
WIRE 816 -880 816 -976
WIRE 912 -880 816 -880
WIRE 1280 -880 1280 -928
WIRE 1280 -880 1264 -880
WIRE 624 -864 624 -960
WIRE 672 -864 624 -864
WIRE 816 -864 816 -880
WIRE 816 -864 752 -864
WIRE 912 -864 912 -880
WIRE 976 -864 912 -864
WIRE 1088 -864 1088 -928
WIRE 1088 -864 1056 -864
WIRE 1168 -864 1088 -864
WIRE 1264 -864 1264 -880
WIRE 1168 -848 1168 -864
WIRE 1232 -848 1168 -848
WIRE 272 -832 272 -848
WIRE 432 -832 272 -832
WIRE 1392 -832 1296 -832
WIRE 1024 -816 928 -816
WIRE 1152 -816 1104 -816
WIRE 1232 -816 1152 -816
WIRE 272 -784 272 -832
WIRE 672 -784 624 -784
WIRE 816 -784 752 -784
WIRE 816 -768 816 -784
WIRE 928 -768 928 -816
WIRE 928 -768 816 -768
WIRE 1264 -768 1264 -800
WIRE 1568 -768 1504 -768
WIRE 1680 -768 1680 -896
WIRE 1680 -768 1648 -768
WIRE 1696 -768 1680 -768
WIRE 1776 -736 1776 -768
WIRE 1696 -720 1696 -768
WIRE 1744 -720 1696 -720
WIRE 1872 -704 1872 -896
WIRE 1872 -704 1808 -704
WIRE 1936 -704 1872 -704
WIRE 1984 -704 1936 -704
WIRE 704 -688 704 -720
WIRE 1392 -688 1392 -832
WIRE 1424 -688 1392 -688
WIRE 1568 -688 1424 -688
WIRE 1744 -688 1696 -688
WIRE 272 -672 272 -704
WIRE 624 -672 624 -784
WIRE 672 -672 624 -672
WIRE 816 -656 816 -768
WIRE 816 -656 736 -656
WIRE 1152 -656 1152 -816
WIRE 1248 -656 1152 -656
WIRE 1392 -656 1392 -688
WIRE 1392 -656 1328 -656
WIRE 1568 -656 1568 -688
WIRE 1680 -656 1648 -656
WIRE 1696 -656 1696 -688
WIRE 1696 -656 1680 -656
WIRE 432 -640 432 -832
WIRE 528 -640 432 -640
WIRE 672 -640 528 -640
WIRE 1776 -640 1776 -672
WIRE 704 -608 704 -624
WIRE 720 -608 704 -608
WIRE 272 -576 272 -592
WIRE 688 -560 688 -592
WIRE 720 -560 720 -608
WIRE 720 -560 688 -560
WIRE 240 -336 160 -336
WIRE -560 -288 -688 -288
WIRE 160 -288 160 -336
WIRE 160 -288 32 -288
WIRE -688 -256 -688 -288
WIRE 32 -256 32 -288
WIRE -16 -240 -208 -240
WIRE -16 -192 -32 -192
WIRE -32 -144 -32 -192
WIRE 32 -144 32 -176
WIRE 944 -96 880 -96
WIRE 1056 -96 944 -96
WIRE 944 -80 944 -96
WIRE 1056 -32 1056 -96
WIRE 1216 -32 1056 -32
WIRE 1248 -32 1216 -32
WIRE 656 -16 528 -16
WIRE 704 -16 656 -16
WIRE 816 -16 784 -16
WIRE 880 -16 816 -16
WIRE 928 -16 880 -16
WIRE 944 -16 928 -16
WIRE 1056 -16 1056 -32
WIRE 1248 -16 1248 -32
WIRE 928 0 928 -16
WIRE 1008 0 928 0
WIRE 320 64 304 64
WIRE 368 64 320 64
WIRE 480 64 368 64
WIRE 368 80 368 64
WIRE 656 80 656 -16
WIRE 704 80 656 80
WIRE 816 80 816 -16
WIRE 816 80 768 80
WIRE -688 96 -768 96
WIRE -640 96 -688 96
WIRE -512 96 -560 96
WIRE -464 96 -512 96
WIRE -384 96 -464 96
WIRE 1056 96 1056 80
WIRE 1168 96 1056 96
WIRE 1248 96 1248 64
WIRE 1248 96 1168 96
WIRE -768 112 -768 96
WIRE -512 112 -512 96
WIRE 1248 160 1248 96
WIRE 368 240 368 160
WIRE 528 240 528 80
WIRE 1248 256 1248 240
FLAG -768 192 0
FLAG -512 176 0
FLAG -384 176 0
FLAG -688 96 vpwm
FLAG -464 96 vfilt
FLAG -688 -176 0
FLAG -560 -288 vcc
FLAG 1264 -768 vcc
FLAG 1776 -768 vcc
FLAG 1248 -896 0
FLAG 1776 -640 0
FLAG 1504 -768 vfilt
FLAG 528 -992 vhi
FLAG 1424 -688 vctrl
FLAG 1936 -704 vout
FLAG 1120 -1024 0
FLAG 528 -640 vlo
FLAG 704 -928 vcc
FLAG 688 -1040 0
FLAG 704 -720 vcc
FLAG 688 -592 0
FLAG 272 -576 0
FLAG 1680 -576 0
FLAG 1248 256 0
FLAG 528 240 0
FLAG 368 240 0
FLAG 1216 -32 vlo
FLAG 1168 96 vsens
FLAG 320 64 vout
FLAG 32 -144 0
FLAG -32 -144 vsens
FLAG -208 -160 0
FLAG 304 -336 vhi
FLAG 160 -208 0
SYMBOL voltage -768 96 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value PULSE(0 3.3 0 1n 1n 0.001374m 0.01374m)
SYMBOL res -544 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 4k
SYMBOL cap -528 112 R0
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res -400 80 R0
SYMATTR InstName R2
SYMATTR Value 100meg
SYMBOL Opamps\\LTC6244 1776 -704 R0
SYMATTR InstName U1
SYMBOL Opamps\\LTC6244 1264 -832 M180
SYMATTR InstName U2
SYMBOL voltage -688 -272 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 6
SYMBOL res 1072 -880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res 1120 -832 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 1344 -672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 1104 -912 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 256 -944 R0
SYMATTR InstName R8
SYMATTR Value 0.01
SYMBOL Opamps\\LTC6244 704 -976 M180
SYMATTR InstName U3
SYMBOL Opamps\\LTC6244 704 -656 R0
SYMATTR InstName U4
SYMBOL res 608 -880 R0
WINDOW 0 35 47 Left 2
SYMATTR InstName R11
SYMATTR Value 2k
SYMBOL res 768 -880 R90
WINDOW 0 51 -4 VBottom 2
WINDOW 3 -25 11 VTop 2
SYMATTR InstName R13
SYMATTR Value 4k
SYMBOL res 768 -800 R90
WINDOW 0 8 -5 VBottom 2
WINDOW 3 31 12 VTop 2
SYMATTR InstName R14
SYMATTR Value 4k
SYMBOL res 256 -800 R0
SYMATTR InstName R10
SYMATTR Value 0.15
SYMBOL voltage 272 -688 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value 3.5
SYMBOL res 1664 -672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 1664 -784 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res 1664 -672 R0
SYMATTR InstName R19
SYMATTR Value 250k
SYMBOL res 1824 -912 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 250k
SYMBOL cap 1792 -1072 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL nmos 480 -16 R0
SYMATTR InstName M1
SYMATTR Value BSS123
SYMBOL pmos 1008 80 M180
SYMATTR InstName M2
SYMATTR Value BSS84
SYMBOL res 352 64 R0
SYMATTR InstName R9
SYMATTR Value 3.3k
SYMBOL res 800 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 1k
SYMBOL res 896 0 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R16
SYMATTR Value 3.3k
SYMBOL res 1264 80 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 86.6k
SYMBOL res 1264 256 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 14.3k
SYMBOL cap 928 -80 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL voltage -208 -256 R0
WINDOW 0 -61 1 Left 2
SYMATTR InstName V3
SYMATTR Value 0.6
SYMBOL e 32 -272 R0
SYMATTR InstName E1
SYMATTR Value 1000
SYMBOL res 144 -304 R0
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL schottky 240 -320 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value MBRB2545CT
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 768 64 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C4
SYMATTR Value 1n
TEXT -560 272 Left 2 !.tran 20m
TEXT -688 -360 Left 2 ;VCC
TEXT -680 0 Left 2 ;MCU PWM output
